# 心脏健康风险评估系统

这是一个基于Python和Flask的医疗健康风险评估系统，专为初级开发者设计。该系统使用机器学习算法（随机森林）来预测用户患心脏疾病的风险。该系统还集成了数据库功能和Linux部署支持，适合初级开发者学习全栈开发和医疗应用开发。

## 项目特点

- **基于Python的全栈开发**：后端使用Flask框架，前端采用HTML、CSS和JavaScript
- **机器学习集成**：使用scikit-learn实现的随机森林算法进行疾病风险预测
- **用户友好界面**：使用Bootstrap框架设计的响应式界面，支持移动端和桌面端
- **实时预测**：用户输入健康数据后，系统立即返回预测结果和可信度
- **数据库存储**：使用SQLite或MySQL存储评估记录，支持历史查询
- **系统监控**：提供系统信息查看功能，包括操作系统、Python版本、数据库状态等
- **历史记录**：查看和管理过去的评估记录
- **Linux支持**：提供完整的Linux部署指南
- **环境配置**：支持通过环境变量灵活配置应用参数

## 技术栈

- **后端**：Python 3.7+, Flask
- **机器学习**：scikit-learn, pandas, numpy
- **数据库**：SQLite (默认), 支持MySQL
- **前端**：HTML5, CSS3, JavaScript, Bootstrap 5
- **其他工具**：joblib（模型持久化）、python-dotenv（配置管理）

## 快速开始

### 前提条件

确保您已安装以下软件：
- Python 3.7或更高版本
- pip（Python包管理器）

### 安装步骤

1. 克隆或下载此项目到本地

```bash
git clone https://your-repository-url/health-risk-assessment.git
cd health-risk-assessment
```

2. 打开命令行终端，导航到项目目录

3. 安装项目依赖：

```bash
pip install -r requirements.txt
```

4. 配置环境变量（可选）

编辑 `.env` 文件，根据您的需求修改配置：

```bash
# 应用配置
DEBUG=True
HOST=127.0.0.1
PORT=5000

# 数据库配置
# 默认使用SQLite（文件数据库，适合开发和小型应用）
DATABASE_URL=sqlite:///health_data.db

# 如需使用MySQL，取消下面的注释并填写相应信息
# DATABASE_URL=mysql+pymysql://username:password@localhost/health_db

# 日志级别
LOG_LEVEL=INFO

# 系统环境标识
# 可选值：development, testing, production
ENV=development
```

5. 运行应用：

```bash
python app.py
```

6. 打开浏览器，访问以下地址：

```
http://localhost:5000
```

## 使用说明

### 健康风险评估

1. 在表单中填写以下健康数据：
   - 年龄
   - 性别
   - 胸痛类型
   - 静息血压
   - 胆固醇水平
   - 空腹血糖
   - 静息心电图结果
   - 最大心率

2. 点击"评估心脏健康风险"按钮

3. 系统将显示评估结果（高风险或低风险）和可信度

4. 点击"重新评估"按钮可以清空表单，进行新的评估

### 历史记录查看

1. 点击右下角的历史记录按钮（时钟图标）

2. 系统将显示最近的评估记录列表

### 系统信息查看

1. 点击右下角的系统信息按钮（服务器图标）

2. 系统将显示当前的系统信息，包括操作系统、Python版本、数据库状态等

## 项目结构

```
heart-risk-assessment/
├── app.py                 # Flask应用的主入口文件
├── requirements.txt       # 项目依赖列表
├── README.md              # 项目说明文档
├── LINUX_DEPLOYMENT.md    # Linux部署指南
├── .env                   # 环境变量配置文件
├── models/                # 存储训练好的模型
│   └── heart_disease_model.pkl  # 心脏病预测模型
└── templates/             # HTML模板文件
    └── index.html         # 主页面模板
```

## 关于模型

该系统使用随机森林分类器进行预测。当首次运行应用时，系统会自动生成模拟的心脏病数据集并训练模型。训练好的模型会保存到`models`文件夹中，以便后续使用。系统会自动生成模拟的心脏疾病数据集进行模型训练，包含以下特征：

- 年龄：患者的年龄
- 性别：1 = 男性，0 = 女性
- 胸痛类型：0-3（典型心绞痛、非典型心绞痛、非心绞痛、无症状）
- 静息血压：静息时的血压(单位: mm Hg)
- 胆固醇：血清胆固醇(单位: mg/dl)
- 空腹血糖：1 = 空腹血糖 > 120 mg/dl，0 = 否
- 静息心电图结果：0-2（正常、有ST-T波异常、左心室肥大）
- 最大心率：运动时达到的最大心率

**注意**：此项目使用的是模拟数据，实际应用中应使用真实的医疗数据集进行训练。在实际应用中，建议使用真实的医疗数据集进行训练，以提高预测准确性。

## 数据库说明

系统默认使用SQLite数据库（`health_data.db`）存储评估记录，表结构如下：

- `id`: 记录ID（主键）
- `age`: 年龄
- `sex`: 性别
- `cp`: 胸痛类型
- `trestbps`: 静息血压
- `chol`: 胆固醇
- `fbs`: 空腹血糖
- `restecg`: 静息心电图结果
- `thalach`: 最大心率
- `result`: 评估结果（高风险/低风险）
- `confidence`: 可信度
- `timestamp`: 评估时间戳

如果需要使用MySQL数据库，请修改 `.env` 文件中的 `DATABASE_URL` 配置。

## Linux部署指南

请参考项目中的 `LINUX_DEPLOYMENT.md` 文件，其中包含了详细的Linux环境部署步骤，包括：

- 系统依赖安装
- Python环境配置
- 项目部署
- 服务管理（使用systemd）
- Nginx反向代理配置
- Linux基础命令学习

## 免责声明

- **医疗免责声明**：本系统仅作为学习和演示目的，不能替代专业医生的诊断。所有预测结果仅供参考，如有健康问题，请及时咨询专业医疗机构。如有心脏不适，请及时就医。
- **数据说明**：示例项目使用模拟数据进行模型训练，预测结果可能不准确，仅供学习和演示使用。
- **安全性**：在生产环境中，请确保正确配置数据库访问权限和应用安全设置。

## 扩展建议

如果您想进一步扩展此项目，可以考虑以下方向：

1. 使用真实的医疗数据集训练模型
2. 添加更多的预测特征，提高预测准确率
3. 集成更多类型的机器学习算法，并比较它们的性能
4. 添加数据可视化功能，展示预测结果和健康指标的关系
5. 实现用户账户系统，允许用户保存和查看历史评估记录
6. 实现用户认证和授权功能
7. 开发更丰富的数据分析和可视化功能
8. 部署到云服务平台
9. 实现API接口供其他应用集成

## 开发者信息

这是一个专为初级开发者设计的医疗相关项目示例，旨在帮助学习Python Web开发和机器学习的基础知识。

## License

MIT

© 2024 心脏健康风险评估系统